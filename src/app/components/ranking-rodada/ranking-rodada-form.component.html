<style>
  /* Adicione estilos personalizados aqui, se necessário */
  .ranking-card {
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  }
  .ranking-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }
  .posicao-box {
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem; /* text-xl */
    font-weight: 700; /* font-bold */
  }
  .icone-apostador {
    width: 2.5rem;
    height: 2.5rem;
    background-color: #cbd5e1; /* gray-300 */
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #4a5568; /* gray-600 */
    font-size: 1.5rem;
  }
  .icone-apostador img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 9999px;
  }
  /* Estilo para destacar a linha inteira do apostador logado */
  .highlighted-user-row {
    background-color: #3b82f6 !important; /* blue-500 */
    color: white !important;
  }
  /* Estilo para ajustar a cor do texto nas linhas destacadas */
  .highlighted-user-row .text-gray-900 {
    color: white !important;
  }
  .highlighted-user-row .text-gray-500 {
    color: #cbd5e1 !important; /* gray-300 */
  }
  .highlighted-user-row .text-green-600 {
    color: white !important;
  }
</style>

<div class="flex flex-col h-full bg-cover bg-center text-gray-900 rounded-lg shadow-lg p-4 sm:p-6"
  style="background-image: url('assets/images/fundobolao.png');">

  <div class="flex justify-between items-center mb-4 pb-3 border-b border-gray-400">
    <h1 class="font-bold text-white min-w-0 flex-shrink-0 text-lg sm:text-xl"
      style="font-size: clamp(0.9rem, 3.5vw, 1.25rem);">
      <span class="text-white">Ranking da Rodada</span>
    </h1>
    <button mat-raised-button color="primary" (click)="goBack()"
      class="px-3 py-1 text-sm sm:px-4 sm:py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105 ml-2">
      <mat-icon>arrow_back</mat-icon>
      Voltar
    </button>
  </div>

  <div *ngIf="isLoading" class="flex flex-col items-center justify-center p-8">
    <mat-spinner color="accent"></mat-spinner>
    <p class="mt-4 text-lg text-gray-600">Carregando ranking...</p>
  </div>

  <div *ngIf="errorMessage && !isLoading" class="bg-red-500 text-white p-3 sm:p-4 rounded-lg shadow-md mb-4 text-center">
    <p class="font-semibold text-md sm:text-lg">{{ errorMessage }}</p>
  </div>

  <mat-card *ngIf="rankingUsuario" class="bg-gray-800 text-white rounded-xl shadow-lg p-4 mb-4">
    <div class="flex items-center space-x-4">
      <div class="posicao-box bg-blue-500 text-white rounded-full">
        {{ rankingUsuario.posicao }}
      </div>
      <div class="icone-apostador">
        <img *ngIf="rankingUsuario.fotoPerfil" 
          [src]="getFotoPerfilUrl(rankingUsuario.fotoPerfil)" 
          alt="Foto de Perfil">
        <mat-icon *ngIf="!rankingUsuario.fotoPerfil">person</mat-icon>
      </div>
      <div class="flex-grow">
        <p class="text-lg font-bold text-white">{{ rankingUsuario.apelido }}</p>
        <p class="text-sm text-gray-400">Pontos: {{ rankingUsuario.pontuacao }}</p>
      </div>
      <div *ngIf="pontosAfastado !== null && pontosAfastado > 0" class="flex flex-col items-end">
        <p class="text-base font-semibold text-red-500">- {{ pontosAfastado }}</p>
        <p class="text-xs text-gray-400">do 1º lugar</p>
      </div>
      <div *ngIf="pontosAfastado === 0" class="flex flex-col items-end">
        <p class="text-base font-semibold text-green-500">1º lugar</p>
      </div>
    </div>
  </mat-card>

  <div *ngIf="!isLoading && !errorMessage" class="flex-grow flex flex-col space-y-4">
    <div *ngIf="ranking.length === 0" class="bg-yellow-100 text-yellow-800 p-3 rounded-lg shadow-md">
      <p>Nenhum ranking disponível para esta rodada.</p>
    </div>
    
    <mat-card *ngFor="let apostador of ranking" 
              class="ranking-card bg-white rounded-xl shadow-md p-4"
              [ngClass]="{'highlighted-user-row': apostador.usuarioId === apostadorLogadoId}">
      <div class="flex items-center space-x-4">
        <div class="posicao-box bg-blue-500 text-white rounded-full">
          {{ apostador.posicao }}
        </div>
        <div class="icone-apostador">
          <img *ngIf="apostador.fotoPerfil" 
            [src]="getFotoPerfilUrl(apostador.fotoPerfil)" 
            alt="Foto de Perfil">
          <mat-icon *ngIf="!apostador.fotoPerfil">person</mat-icon>
        </div>
        <div class="flex-grow">
          <p class="text-lg font-bold text-gray-900">{{ apostador.apelido }}</p>
          <p class="text-sm text-gray-500">Última atualização: {{ apostador.dataAtualizacao | date:'short' }}</p>
        </div>
        <div class="flex flex-col items-end">
          <p class="text-lg font-bold text-green-600">{{ apostador.pontuacao }}</p>
          <p class="text-xs text-gray-500">Pontos</p>
        </div>
      </div>
    </mat-card>
  </div>
</div>