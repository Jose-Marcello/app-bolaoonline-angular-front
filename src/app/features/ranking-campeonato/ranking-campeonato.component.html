<style>
  /* Adicionando o efeito de medalha para o Top 3 */
  .posicao-1 { background-color: #fbbf24 !important; color: #000 !important; } /* Ouro */
  .posicao-2 { background-color: #94a3b8 !important; color: #fff !important; } /* Prata */
  .posicao-3 { background-color: #b45309 !important; color: #fff !important; } /* Bronze */

  .ranking-card {
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  }
  .ranking-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
  }
  .posicao-box {
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    font-weight: 800;
  }
</style>

<div class="relative flex flex-col h-full bg-cover bg-center rounded-lg shadow-lg overflow-hidden"
     style="background-image: url('assets/images/fundobolao.png');">
  
  <div class="absolute inset-0 bg-slate-900/60"></div>

  <div class="relative z-10 p-4 sm:p-6 flex flex-col h-full">
    
    <div class="flex justify-between items-center mb-4 pb-3 border-b border-gray-400/30">
      <h1 class="font-bold text-white min-w-0 flex-shrink-0 text-lg sm:text-xl">
        Ranking do Campeonato
      </h1>
      <button mat-raised-button color="primary" (click)="goBack()"
        class="px-3 py-1 text-sm bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-full shadow-md transition duration-300 transform hover:scale-105 ml-2">
        <mat-icon>arrow_back</mat-icon>
        Voltar
      </button>
    </div>

    <div *ngIf="isLoading" class="flex flex-col items-center justify-center p-8">
      <mat-spinner color="accent" diameter="50"></mat-spinner>
      <p class="mt-4 text-lg text-white/80">Carregando classificação...</p>
    </div>

    <mat-card *ngIf="rankingUsuario && !isLoading" class="bg-slate-800 text-white rounded-xl shadow-2xl p-4 mb-6 border border-indigo-500/30">
      <div class="flex items-center space-x-4">
        <div class="posicao-box rounded-full shadow-inner" 
             [ngClass]="{'posicao-1': rankingUsuario.posicao === 1, 'posicao-2': rankingUsuario.posicao === 2, 'posicao-3': rankingUsuario.posicao === 3, 'bg-blue-600': rankingUsuario.posicao > 3}">
          {{ rankingUsuario.posicao }}
        </div>
        <div class="w-12 h-12 rounded-full overflow-hidden border-2 border-white/20">
          <img *ngIf="rankingUsuario.fotoPerfil" [src]="getFotoPerfilUrl(rankingUsuario.fotoPerfil)" class="w-full h-full object-cover">
          <mat-icon *ngIf="!rankingUsuario.fotoPerfil" class="scale-150 text-slate-400">person</mat-icon>
        </div>
        <div class="flex-grow">
          <p class="text-lg font-black text-white m-0 uppercase leading-none">{{ rankingUsuario.apelido }}</p>
          <p class="text-xs text-indigo-300 font-bold mt-1">Sua Pontuação: {{ rankingUsuario.pontuacao }} PTS</p>
        </div>
        <div class="text-right">
          <p *ngIf="pontosAfastado > 0" class="text-base font-black text-rose-500 m-0">- {{ pontosAfastado }}</p>
          <p *ngIf="pontosAfastado === 0" class="text-base font-black text-emerald-400 m-0">LÍDER</p>
          <p class="text-[9px] text-gray-400 uppercase font-bold">do 1º lugar</p>
        </div>
      </div>
    </mat-card>

    <div *ngIf="!isLoading" class="flex-grow space-y-3 overflow-y-auto pr-1">
      <mat-card *ngFor="let apostador of ranking" 
                class="ranking-card transition-all border border-transparent"
                [ngClass]="{
                  'highlighted-user-row shadow-indigo-500/20 border-indigo-500/50': apostador.apostadorId === apostadorLogadoId,
                  'bg-white/95': apostador.apostadorId !== apostadorLogadoId
                }">
        <div class="flex items-center space-x-4 p-1">
          <div class="posicao-box rounded-full shadow-sm"
               [ngClass]="{'posicao-1': apostador.posicao === 1, 'posicao-2': apostador.posicao === 2, 'posicao-3': apostador.posicao === 3, 'bg-slate-200 text-slate-700': apostador.posicao > 3 && apostador.apostadorId !== apostadorLogadoId, 'bg-white text-blue-600': apostador.apostadorId === apostadorLogadoId && apostador.posicao > 3}">
            {{ apostador.posicao }}
          </div>

          <div class="w-10 h-10 rounded-full overflow-hidden bg-slate-100 flex items-center justify-center">
            <img *ngIf="apostador.fotoPerfil" [src]="getFotoPerfilUrl(apostador.fotoPerfil)" class="w-full h-full object-cover">
            <mat-icon *ngIf="!apostador.fotoPerfil" class="text-slate-400">person</mat-icon>
          </div>

          <div class="flex-grow min-w-0">
            <p class="text-sm font-black truncate uppercase" 
               [ngClass]="apostador.apostadorId === apostadorLogadoId ? 'text-white' : 'text-slate-800'">
              {{ apostador.apelido }}
            </p>
            <p class="text-[10px]" [ngClass]="apostador.apostadorId === apostadorLogadoId ? 'text-blue-100' : 'text-slate-500'">
              Atualizado em {{ apostador.dataAtualizacao | date:'dd/MM HH:mm' }}
            </p>
          </div>

          <div class="text-right">
            <p class="text-lg font-black leading-none" 
               [ngClass]="apostador.apostadorId === apostadorLogadoId ? 'text-white' : 'text-emerald-600'">
              {{ apostador.pontuacao }}
            </p>
            <p class="text-[9px] font-bold uppercase" [ngClass]="apostador.apostadorId === apostadorLogadoId ? 'text-blue-200' : 'text-slate-400'">Pontos</p>
          </div>
        </div>
      </mat-card>
    </div>
  </div>
</div>