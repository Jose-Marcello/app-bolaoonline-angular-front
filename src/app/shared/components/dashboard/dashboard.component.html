
<div class="marketing-banner">
  <p class="text-muted small">Parceiro Oficial:</p>
  <img src="assets/marketing/parceiros/logo-espaco-mar.jpeg" 
       alt="Espaço Mar Fitness" 
       style="max-width: 150px; border-radius: 8px;">
</div>

<div class="dashboard-container p-6 md:p-10">
  <div *ngIf="isLoading" class="flex justify-center items-center h-full">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <div *ngIf="!isLoading && !errorMessage" class="container mx-auto">
    
    <div class="my-2">
      <mat-card class="rounded-lg shadow-md bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <mat-icon class="text-xl">account_balance_wallet</mat-icon>
            <span class="text-lg font-bold">Saldo Atual</span>
          </div>
          <span class="text-2xl font-bold">{{ apostadorSaldo | currency:'BRL':'symbol':'1.2-2' }}</span>
        </div>
        <div class="mt-4 flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 w-full md:w-auto md:justify-center">
          <button mat-flat-button color="primary" class="w-full text-sm" (click)="navigateToDepositar()">
            <mat-icon>add</mat-icon> Depositar
          </button>
          <button mat-flat-button color="accent" class="w-full text-sm" (click)="navigateToSacar()">
            <mat-icon>remove</mat-icon> Sacar
          </button>
        </div>
      </mat-card>
    </div>

    <div class="text-center mb-6 mt-4">
      <h2 class="text-2xl font-bold text-gray-800">Campeonatos Disponíveis</h2>
    </div>

    <div class="flex flex-row overflow-x-auto gap-6 md:grid md:grid-cols-2 lg:grid-cols-3">
      
      <mat-card *ngFor="let campeonato of campeonatosDisponiveis" class="p-4">
        
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center">
            <img [src]="getCampeonatoLogo(campeonato.nome)" alt="Logo" class="w-12 h-12 rounded-full mr-4 object-cover">
            <div class="flex-1">
              <mat-card-title class="text-lg font-bold text-gray-800">{{ campeonato.nome }}</mat-card-title>
              <mat-card-subtitle class="text-sm text-gray-600">
                {{ campeonato.dataInicio | date:'shortDate' }} - {{ campeonato.dataFim | date:'shortDate' }}
              </mat-card-subtitle>
            </div>
          </div>
          <div *ngIf="campeonato.aderidoPeloUsuario" class="bg-green-500 text-white text-xs font-bold py-1 px-2 rounded-full">
            JOGANDO!
          </div>
          <div *ngIf="!campeonato.aderidoPeloUsuario" class="bg-orange-700 text-white text-xs font-bold py-1 px-2 rounded-full">
            VAMOS JOGAR!
          </div>
        </div>

        <div *ngIf="campeonatoTotais[campeonato.id]" class="bg-gray-100 p-3 rounded-lg border border-gray-300 mb-4">
          <div class="flex flex-col space-y-1 text-gray-700">
            <div class="flex items-center justify-between">
              <span class="text-xs">Apostadores:</span>
              <span class="text-xs font-bold">{{ campeonatoTotais[campeonato.id].numeroDeApostadores }}</span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-xs">Arrecadado:</span>
              <span class="text-xs font-bold text-blue-800">{{ campeonatoTotais[campeonato.id].valorTotalArrecadado | currency:'BRL' }}</span>
            </div>
          </div>
        </div>
        
        <div class="flex flex-col space-y-4">
          <div class="moldura-status-rodada" *ngIf="campeonato.rodadasEmAposta?.length > 0">
            <app-apostas-totais-card
              titulo="Rodada em Aposta"
              [campeonato]="campeonato"
              [rodada]="campeonato.rodadasEmAposta[0]">
            </app-apostas-totais-card>
            <button mat-flat-button class="botao_aposta_rodada w-full mt-2" (click)="navegarParaApostasRodada(campeonato.id, campeonato.rodadasEmAposta[0].id)">
              <mat-icon>sports_soccer</mat-icon> Apostar (Próxima Rodada) ({{ campeonato.rodadasEmAposta.length }})
            </button>
          </div>
          
          <div class="moldura-status-rodada" *ngIf="campeonato.rodadasCorrentes?.length > 0">
            <app-apostas-totais-card
              titulo="Rodada Corrente"
              [campeonato]="campeonato"
              [rodada]="campeonato.rodadasCorrentes[0]">
            </app-apostas-totais-card>
            <button mat-flat-button class="botao_resultado_rodada w-full mt-2" (click)="verRodadasCorrentes(campeonato.id)">
              <mat-icon>trending_up</mat-icon> Resultados (Rodada Corrente) ({{ campeonato.rodadasCorrentes.length }})
            </button>
          </div>
          
          <div class="moldura-status-rodada">
            <div class="flex items-center gap-2 mb-3 border-b pb-2 border-slate-200">
              <mat-icon style="color: #1e3a8a">history</mat-icon>
              <span class="font-bold text-slate-700">Histórico do Campeonato</span>
            </div>

            <div class="space-y-1 mb-4" *ngIf="campeonatoTotais[campeonato.id]">
              <div class="text-xs flex justify-between">
                <span>Total Geral Arrecadado:</span> 
                <!--<span class="font-semibold">{{ campeonatoTotais[campeonato.id].valorTotalArrecadado | currency:'BRL' }}</span> -->
                <span class="font-semibold">{{ 0 | currency:'BRL' }}</span>
              </div>
              <div class="text-xs flex justify-between">
                <span>Total Pago em Prêmios:</span> 
                <!--<span class="font-bold text-green-700">{{ campeonatoTotais[campeonato.id].valorTotalPago | currency:'BRL' }}</span>-->
                <span class="font-bold text-green-700">{{ 0 | currency:'BRL' }}</span>
              </div>
            </div> 
          
            <button mat-raised-button class="botao_rodadas_finalizadas w-full" 
                    [disabled]="campeonato.rodadasFinalizadas?.length === 0"
                    (click)="verRodadasFinalizadas(campeonato.id)">
                <mat-icon>manage_search</mat-icon>
                VER RODADAS ANTERIORES ({{ campeonato.rodadasFinalizadas?.length || 0 }})
            </button>
          </div>
        </div> <div class="card-actions flex flex-col space-y-2 mt-4" *ngIf="!campeonato.aderidoPeloUsuario">
          <button mat-flat-button color="primary" class="w-full" (click)="entrarEmCampeonato(campeonato.id)">
            <mat-icon>add_circle_outline</mat-icon> Aderir ao Campeonato
          </button>
        </div>
      </mat-card> </div> </div> <div *ngIf="errorMessage" class="text-red-500 text-center mt-8">{{ errorMessage }}</div>
</div> 

